<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أداة علم وشفاء بالشراكة مع S22MARKET | لوحة الإحصائيات</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; scroll-behavior: smooth; }
        .hero-bg { background-color: #1a202c; background-image: radial-gradient(circle at 1px 1px, #374151 1px, transparent 0); background-size: 20px 20px; }
        .card { transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .card:hover { transform: translateY(-10px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Styles for professional Toast notifications */
        .toast-container {
            position: fixed;
            bottom: 1.5rem;
            left: 1.5rem;
            z-index: 50;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .toast {
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            color: white;
            font-weight: 600;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            opacity: 0;
            transform: translateX(-100%);
            animation: slide-in 0.5s forwards;
        }
        @keyframes slide-in {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        /* Simple style for inline SVG icons */
        .icon {
            display: inline-block;
            width: 1.2em;
            height: 1.2em;
            vertical-align: middle;
            margin-right: 0.5em;
        }
        /* Countdown Timer Styles */
        .countdown-container {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 0.75rem;
            padding: 1rem;
            margin-top: 1rem;
        }
        .countdown-timer {
            display: flex;
            justify-content: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffffff;
        }
        .countdown-timer > div {
            text-align: center;
        }
        .countdown-timer > div > span {
            display: block;
            font-size: 0.8rem;
            font-weight: 400;
            color: #d1d5db;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200">

    <div id="toast-container" class="toast-container"></div>

    <main id="landing-page">
        <section class="hero-bg text-white shadow-lg">
            <div class="container mx-auto px-6 py-20 text-center">
                <h1 class="text-4xl md:text-6xl font-extrabold leading-tight">السلام عليكم ورحمـة الله وبركاته</h1>

<p class="mt-3 text-base sm:text-lg md:text-xl text-gray-300 leading-relaxed text-center max-w-2xl sm:max-w-3xl mx-auto px-4">
  نتشرف اليوم بتقديم تطبيقاتنا الجديدة والمبتكرة، ثمرة شراكة استراتيجية بين 
  <span class="font-semibold text-white">أداة علم</span>، 
  <span class="font-semibold text-white">أداة شفاء</span>، و 
  <span class="font-semibold text-white">S22MARKET</span>.
</p>



                <a href="#applications" class="mt-8 inline-block bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-full text-lg transition-transform transform hover:scale-105">
                    اكتشف التطبيقات
                </a>
            </div>
        </section>

        <section id="stats" class="bg-gray-50 dark:bg-gray-800 py-16 sm:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white">مشاريعنا بالأرقام (مباشر)</h2>
                    <p class="mt-3 text-gray-600 dark:text-gray-400">إحصائيات لحظية يتم تحديثها تلقائياً  .</p>
                </div>
                <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 text-center">
                    <div class="bg-white dark:bg-gray-700 p-8 rounded-2xl shadow-lg">
                        <p id="stats-page-visits" class="text-5xl font-extrabold text-indigo-500"><span class="loader"></span></p>
                        <p class="mt-2 text-xl font-bold text-gray-800 dark:text-white">إجمالي زيارات الصفحة</p>
                    </div>
                    <div class="bg-white dark:bg-gray-700 p-8 rounded-2xl shadow-lg">
                        <p id="stats-total-downloads" class="text-5xl font-extrabold text-teal-500"><span class="loader"></span></p>
                        <p class="mt-2 text-xl font-bold text-gray-800 dark:text-white">إجمالي التحميلات</p>
                    </div>
                    <div class="bg-white dark:bg-gray-700 p-8 rounded-2xl shadow-lg">
                        <p id="stats-platform-visits" class="text-5xl font-extrabold text-amber-500"><span class="loader"></span></p>
                        <p class="mt-2 text-xl font-bold text-gray-800 dark:text-white">إجمالي زيارات المنصات</p>
                    </div>
                    <div class="bg-white dark:bg-gray-700 p-8 rounded-2xl shadow-lg">
                        <p class="text-5xl font-extrabold text-green-500">∞</p>
                        <p class="mt-2 text-xl font-bold text-gray-800 dark:text-white">مشاريع قادمة</p>
                    </div>
                </div>

                <div class="mt-16">
                    <div class="text-center mb-8">
                        <h3 class="text-2xl md:text-3xl font-bold text-gray-900 dark:text-white">تفاصيل تحميلات التطبيقات</h3>
                    </div>
                    <div class="max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-2xl shadow-lg">
                            <p id="stats-downloads-shifa" class="text-4xl font-extrabold text-red-500"><span class="loader"></span></p>
                            <p class="mt-2 text-lg font-bold text-gray-800 dark:text-white">تحميلات أداة شفاء</p>
                        </div>
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-2xl shadow-lg">
                            <p id="stats-downloads-elm" class="text-4xl font-extrabold text-indigo-500"><span class="loader"></span></p>
                            <p class="mt-2 text-lg font-bold text-gray-800 dark:text-white">تحميلات أداة علم</p>
                        </div>
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-2xl shadow-lg">
                            <p id="stats-downloads-market" class="text-4xl font-extrabold text-green-500"><span class="loader"></span></p>
                            <p class="mt-2 text-lg font-bold text-gray-800 dark:text-white">تحميلات متجر الطلبة</p>
                        </div>
                    </div>
                </div>

               
            </div>
        </section>

        <section id="applications" class="bg-white dark:bg-black py-16 sm:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white">تطبيقاتنـا ومنصاتنـا</h2>
                    <p class="mt-3 text-gray-600 dark:text-gray-400">هذه هي بعض مشاريعنا الحالية المتوفرة، والمزيد قادم بإذن الله!</p>
                </div>
                
                <div class="max-w-4xl mx-auto bg-indigo-900/50 border border-indigo-700 text-white p-6 rounded-2xl shadow-lg mb-12 text-center">
                    <h3 class="text-2xl font-bold">مشاريع قادمة في أداة علم!</h3>
                    <p class="mt-2 text-indigo-200">نعمل على إضافة تخصصات جديدة. ترقبوها خلال:</p>
                    <div class="countdown-container">
                        <div id="countdown-elm" class="countdown-timer">
                            </div>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="card bg-gray-50 dark:bg-gray-800 rounded-2xl shadow-lg p-8 flex flex-col border-t-4 border-red-500">
                        <h3 class="text-2xl font-bold mb-3 text-red-500">أداة شفاء</h3>
                        <p class="font-semibold text-lg mb-2 text-gray-800 dark:text-white">تطبيق التبرع بالدم</p>
                        <p class="text-gray-600 dark:text-gray-300 mb-4 flex-grow">يهدف هذا التطبيق الإنساني لتسهيل عملية التبرع بالدم، وإنشاء شبكة فعالة تربط المتبرعين بالمحتاجين بشكل عاجل ومنظم.</p>
                        <div class="mt-auto pt-4 border-t border-gray-200 dark:border-gray-700 flex flex-col gap-3">
                            <a href="التبرع بالدم أداة شفاء.apk" id="download-shifa" class="w-full text-center bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105 flex items-center justify-center">
                                <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19.95 4.05C21.4 5.5 22 7.74 22 10.04V10C22 12.24 21.4 14.5 19.95 15.95L18.54 14.54C19.5 13.57 20 12.04 20 10C20 7.96 19.5 6.43 18.54 5.46L19.95 4.05M4.05 19.95C5.5 21.4 7.74 22 10.04 22H10C12.24 22 14.5 21.4 15.95 19.95L14.54 18.54C13.57 19.5 12.04 20 10 20C7.96 20 6.43 19.5 5.46 18.54L4.05 19.95M16.95 8.5C17.3 8.85 17.5 9.42 17.5 10C17.5 10.58 17.3 11.15 16.95 11.5L15.54 10.09L16.95 8.5M7.05 15.5C6.7 15.15 6.5 14.58 6.5 14C6.5 13.42 6.7 12.85 7.05 12.5L8.46 13.91L7.05 15.5M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z"/></svg>
                                <span>تحميل لأندرويد (.apk)</span>
                            </a>
                            <a href="https://adatshifa.github.io/altabarue_bialdam/home_altabarue_bialdam.html" id="platform-shifa" target="_blank" class="w-full text-center bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">فتح المنصة</a>
                            <button id="copy-link-shifa" class="w-full text-center bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">نسخ رابط المنصة</button>
                        </div>
                    </div>

                    <div class="card bg-gray-50 dark:bg-gray-800 rounded-2xl shadow-lg p-8 flex flex-col border-t-4 border-indigo-500">
                        <h3 class="text-2xl font-bold mb-3 text-indigo-500">أداة علم</h3>
                        <p class="font-semibold text-lg mb-2 text-gray-800 dark:text-white">تطبيق الطب</p>
                        <p class="text-gray-600 dark:text-gray-300 mb-4 flex-grow">منصة تعليمية متكاملة تهدف إلى دعم طلبة الكليات الطبية وتوفير المصادر والأدوات اللازمة لتسهيل مسيرتهم الدراسية.</p>
                        <div class="mt-auto pt-4 border-t border-gray-200 dark:border-gray-700 flex flex-col gap-3">
                             <a href="الطب أداة علم .apk" id="download-elm" class="w-full text-center bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105 flex items-center justify-center">
                                <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19.95 4.05C21.4 5.5 22 7.74 22 10.04V10C22 12.24 21.4 14.5 19.95 15.95L18.54 14.54C19.5 13.57 20 12.04 20 10C20 7.96 19.5 6.43 18.54 5.46L19.95 4.05M4.05 19.95C5.5 21.4 7.74 22 10.04 22H10C12.24 22 14.5 21.4 15.95 19.95L14.54 18.54C13.57 19.5 12.04 20 10 20C7.96 20 6.43 19.5 5.46 18.54L4.05 19.95M16.95 8.5C17.3 8.85 17.5 9.42 17.5 10C17.5 10.58 17.3 11.15 16.95 11.5L15.54 10.09L16.95 8.5M7.05 15.5C6.7 15.15 6.5 14.58 6.5 14C6.5 13.42 6.7 12.85 7.05 12.5L8.46 13.91L7.05 15.5M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z"/></svg>
                                <span>تحميل لأندرويد (.apk)</span>
                            </a>
                            <a href="https://s22mcs.github.io/S22MCS02-/adatealm_med.html" id="platform-elm" target="_blank" class="w-full text-center bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">فتح المنصة</a>
                             <button id="copy-link-elm" class="w-full text-center bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">نسخ رابط المنصة</button>
                        </div>
                    </div>

                    <div class="card bg-gray-50 dark:bg-gray-800 rounded-2xl shadow-lg p-8 flex flex-col border-t-4 border-green-500">
                        <h3 class="text-2xl font-bold mb-3 text-green-500">متجر الطلبة</h3>
                        <p class="font-semibold text-lg mb-2 text-gray-800 dark:text-white">سوق متكامل للطالب</p>
                        <p class="text-gray-600 dark:text-gray-300 mb-4 flex-grow">منصة شاملة توفر كل ما يحتاجه الطالب، وتتيح لهم عرض سلعهم وخدماتهم للبيع، مما يخلق بيئة اقتصادية طلابية متكاملة.</p>
                        <div class="mt-auto pt-4 border-t border-gray-200 dark:border-gray-700 flex flex-col gap-3">
                             <a href="S22MARKET.apk" id="download-market" class="w-full text-center bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105 flex items-center justify-center">
                                <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19.95 4.05C21.4 5.5 22 7.74 22 10.04V10C22 12.24 21.4 14.5 19.95 15.95L18.54 14.54C19.5 13.57 20 12.04 20 10C20 7.96 19.5 6.43 18.54 5.46L19.95 4.05M4.05 19.95C5.5 21.4 7.74 22 10.04 22H10C12.24 22 14.5 21.4 15.95 19.95L14.54 18.54C13.57 19.5 12.04 20 10 20C7.96 20 6.43 19.5 5.46 18.54L4.05 19.95M16.95 8.5C17.3 8.85 17.5 9.42 17.5 10C17.5 10.58 17.3 11.15 16.95 11.5L15.54 10.09L16.95 8.5M7.05 15.5C6.7 15.15 6.5 14.58 6.5 14C6.5 13.42 6.7 12.85 7.05 12.5L8.46 13.91L7.05 15.5M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z"/></svg>
                                <span>تحميل لأندرويد (.apk)</span>
                            </a>
                            <a href="https://s22market.github.io/S22MARKET/" id="platform-market" target="_blank" class="w-full text-center bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">فتح المنصة</a>
                             <button id="copy-link-market" class="w-full text-center bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">نسخ رابط المنصة</button>
                        </div>
                    </div>
                    
                    <div class="card bg-gray-100 dark:bg-gray-800 rounded-2xl shadow-lg p-8 flex flex-col border-t-4 border-cyan-500 items-center justify-center text-center">
                        <h3 class="text-2xl font-bold mb-3 text-cyan-500">أداة علم: الصيدلة</h3>
                        <p class="font-semibold text-lg mb-4 text-gray-800 dark:text-white">تطبيق متخصص لطلبة الصيدلة</p>
                        <div class="flex-grow flex items-center justify-center">
                            <p class="text-2xl font-bold text-gray-500 dark:text-gray-400">قريباً إن شاء الله</p>
                        </div>
                    </div>
                    
                    <div class="card bg-gray-100 dark:bg-gray-800 rounded-2xl shadow-lg p-8 flex flex-col border-t-4 border-blue-500 items-center justify-center text-center">
                        <h3 class="text-2xl font-bold mb-3 text-blue-500">أداة علم: طب أسنان</h3>
                        <p class="font-semibold text-lg mb-4 text-gray-800 dark:text-white">تطبيق متخصص لطلبة طب الأسنان</p>
                        <div class="flex-grow flex items-center justify-center">
                            <p class="text-2xl font-bold text-gray-500 dark:text-gray-400">قريباً إن شاء الله</p>
                        </div>
                    </div>
                    
                    <div class="card bg-gray-100 dark:bg-gray-800 rounded-2xl shadow-lg p-8 flex flex-col border-t-4 border-orange-500 items-center justify-center text-center">
                        <h3 class="text-2xl font-bold mb-3 text-orange-500">أداة علم: الشبه طبي</h3>
                        <p class="font-semibold text-lg mb-4 text-gray-800 dark:text-white">تطبيق متخصص لطلبة الشبه طبي</p>
                        <div class="flex-grow flex items-center justify-center">
                            <p class="text-2xl font-bold text-gray-500 dark:text-gray-400">قريباً إن شاء الله</p>
                        </div>
                    </div>
                    
                    <div class="card bg-gray-900 border-2 border-dashed border-red-700 rounded-2xl shadow-lg p-8 flex flex-col items-center justify-center text-center md:col-span-2 lg:col-span-3">
                        <h3 class="text-2xl font-bold mb-3 text-red-500">مشروع أداة شفاء القادم: باء المجهول</h3>
                        <p class="font-semibold text-lg mb-2 text-gray-300">قريباً... مشروع إنساني جديد ومبتكر.</p>
                        <p class="text-red-300">المتبقي عن الكشف عنه:</p>
                        <div class="w-full max-w-md">
                           <div class="countdown-container bg-transparent p-0">
                               <div id="countdown-shifa" class="countdown-timer text-red-400">
                                   </div>
                           </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <footer class="bg-gray-800 dark:bg-black text-white py-10">
            <div class="container mx-auto px-6 text-center">
                <p class="text-2xl font-bold mb-4">انضموا إلى مجتمعاتنا</p>
                <p class="text-gray-400 mb-6">يمكنكم الاطلاع على آخر أخبارنا ومشاريعنا عبر متابعة صفحاتنا على تيليجرام.</p>
                <div class="flex justify-center items-center gap-6 flex-wrap mb-8">
                    <a href="https://t.me/adatealm" target="_blank" class="font-bold hover:text-indigo-400 transition">أداة علم</a>
                    <a href="https://t.me/adatshifa" target="_blank" class="font-bold hover:text-red-400 transition">أداة شفاء</a>
                    <a href="https://t.me/S22MARKET" target="_blank" class="font-bold hover:text-green-400 transition">S22MARKET</a>
                </div>
                <div class="text-sm text-gray-500 border-t border-gray-700 pt-6">
                    <p>&copy; 2025 - جميع الحقوق محفوظة. تم التطوير بالشراكة بين أداة علم، أداة شفاء، و S22MARKET.</p>
                </div>
            </div>
        </footer>
    </main>

    <script type="module">
        // Import necessary functions from Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, doc, setDoc, increment, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Your Firebase project configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC_M8gdp2jAA1mIGTzGbNlGHYxsbqk6ezs",
            authDomain: "sharaka-ee447.firebaseapp.com",
            projectId: "sharaka-ee447",
            storageBucket: "sharaka-ee447.firebasestorage.app",
            messagingSenderId: "1075205615477",
            appId: "1:1075205615477:web:fe16d9bd8ae759addc2d3c",
            measurementId: "G-H7J65XMZQ0"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const statsDocRef = doc(db, "pageStats", "counters");

        // --- Toast Notification Function ---
        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;

            if (type === 'success') toast.style.backgroundColor = '#28a745'; // Green
            else if (type === 'error') toast.style.backgroundColor = '#dc3545'; // Red
            else toast.style.backgroundColor = '#17a2b8'; // Blue (info)
            
            container.appendChild(toast);

            setTimeout(() => { toast.remove(); }, 3000);
        }
        
        // --- Firebase Counter Function ---
        async function incrementCounter(fieldName) {
            try {
                await setDoc(statsDocRef, { [fieldName]: increment(1) }, { merge: true });
            } catch (error) {
                console.error(`Failed to increment counter for ${fieldName}:`, error);
                throw error;
            }
        }

        // --- Real-time Stats Listener ---
        onSnapshot(statsDocRef, (docSnap) => {
            const UIElements = {
                pageVisits: document.getElementById('stats-page-visits'),
                totalDownloads: document.getElementById('stats-total-downloads'),
                platformVisits: document.getElementById('stats-platform-visits'),
                downloadsShifa: document.getElementById('stats-downloads-shifa'),
                downloadsElm: document.getElementById('stats-downloads-elm'),
                downloadsMarket: document.getElementById('stats-downloads-market'),
                visitsShifa: document.getElementById('stats-visits-shifa'),
                visitsElm: document.getElementById('stats-visits-elm'),
                visitsMarket: document.getElementById('stats-visits-market'),
            };
            
            if (docSnap.exists()) {
                const data = docSnap.data();
                const counters = {
                    page_visits: data.page_visits || 0,
                    download_shifa: data.download_shifa || 0,
                    download_elm: data.download_elm || 0,
                    download_market: data.download_market || 0,
                    platform_shifa: data.platform_shifa || 0,
                    platform_elm: data.platform_elm || 0,
                    platform_market: data.platform_market || 0,
                };

                const totalDownloads = counters.download_shifa + counters.download_elm + counters.download_market;
                const totalPlatformVisits = counters.platform_shifa + counters.platform_elm + counters.platform_market;

                UIElements.pageVisits.textContent = counters.page_visits;
                UIElements.totalDownloads.textContent = totalDownloads;
                UIElements.platformVisits.textContent = totalPlatformVisits;
                UIElements.downloadsShifa.textContent = counters.download_shifa;
                UIElements.downloadsElm.textContent = counters.download_elm;
                UIElements.downloadsMarket.textContent = counters.download_market;
                UIElements.visitsShifa.textContent = counters.platform_shifa;
                UIElements.visitsElm.textContent = counters.platform_elm;
                UIElements.visitsMarket.textContent = counters.platform_market;

            } else {
                Object.values(UIElements).forEach(el => el.textContent = '0');
                console.log("Stats document not found. It will be created on the first user action.");
            }
        });

        // --- Event Listeners on Page Load ---
        document.addEventListener('DOMContentLoaded', () => {
            incrementCounter('page_visits').catch(err => console.error("Could not register page visit."));

            const setupDownloadButton = (buttonId, counterName) => {
                const button = document.getElementById(buttonId);
                if (!button) return;
                button.addEventListener('click', async (e) => {
                    e.preventDefault();
                    const url = e.currentTarget.href;
                    showToast('...جاري تسجيل التحميل وبدء التنزيل', 'info');
                    try {
                        await incrementCounter(counterName);
                        window.location.href = url;
                    } catch (error) {
                        showToast('فشل تسجيل التحميل، لكن التنزيل سيبدأ', 'error');
                        window.location.href = url;
                    }
                });
            };

            const setupCopyButton = (buttonId, platformLinkId, counterName) => {
                const button = document.getElementById(buttonId);
                const platformLink = document.getElementById(platformLinkId);
                if (!button || !platformLink) return;

                button.addEventListener('click', async () => {
                    const url = platformLink.href;
                    try {
                        await navigator.clipboard.writeText(url);
                        showToast('تم نسخ الرابط بنجاح!', 'success');
                        // Increment counter on successful copy
                        incrementCounter(counterName);
                    } catch (err) {
                        showToast('فشل نسخ الرابط.', 'error');
                        console.error('Failed to copy: ', err);
                    }
                });
            };

            // Setup all buttons
            setupDownloadButton('download-shifa', 'download_shifa');
            setupDownloadButton('download-elm', 'download_elm');
            setupDownloadButton('download-market', 'download_market');

            document.getElementById('platform-shifa').addEventListener('click', () => incrementCounter('platform_shifa'));
            document.getElementById('platform-elm').addEventListener('click', () => incrementCounter('platform_elm'));
            document.getElementById('platform-market').addEventListener('click', () => incrementCounter('platform_market'));
            
            setupCopyButton('copy-link-shifa', 'platform-shifa', 'platform_shifa');
            setupCopyButton('copy-link-elm', 'platform-elm', 'platform_elm');
            setupCopyButton('copy-link-market', 'platform-market', 'platform_market');
        });
    </script>
    
    <script>
        function startCountdown(elementId, days) {
            const countdownElement = document.getElementById(elementId);
            if (!countdownElement) return;

            const targetDate = new Date().getTime() + (days * 24 * 60 * 60 * 1000);

            const interval = setInterval(() => {
                const now = new Date().getTime();
                const distance = targetDate - now;

                if (distance < 0) {
                    clearInterval(interval);
                    countdownElement.innerHTML = "<div class='text-2xl'>حان الوقت!</div>";
                    return;
                }

                const d = Math.floor(distance / (1000 * 60 * 60 * 24));
                const h = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((distance % (1000 * 60)) / 1000);

                countdownElement.innerHTML = `
                    <div>${d}<span>يوم</span></div>
                    <div>${h}<span>ساعة</span></div>
                    <div>${m}<span>دقيقة</span></div>
                    <div>${s}<span>ثانية</span></div>
                `;
            }, 1000);
        }

        document.addEventListener('DOMContentLoaded', () => {
            startCountdown('countdown-elm', 20);
            startCountdown('countdown-shifa', 60);
        });
    </script>
</body>
</html>